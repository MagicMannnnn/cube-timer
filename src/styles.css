/* === styles.css (clean + working mobile drag) === */
:root{
  --bg:#0f1115;
  --text:#e7e7e7;
  --muted:#9aa1a9;
  --accent:#3a7afe;
  --border:#252932;
  --sidebar-bg:#151821;
  --panel-bg:#0e1117;
  --timer-color:#e7e7e7;
  --radius:14px;
  --space:12px;
  --sidebar-w:300px;

  /* Scrollbars */
  --scroll-track:#0d1117;
  --scroll-thumb:#2a2f3a;
  --scroll-thumb-hover:#3a4150;

  /* Resizable bottom stack */
  --dock-h:160px;       /* bottom dock height */
  --sidebar-h:160px;    /* mobile sidebar height */
  --stack-max:70vh;     /* shared budget (used by JS logic) */
}

/* Base */
*{box-sizing:border-box}
html,body,#root{height:100%; overflow:hidden}
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;
}
button,input,select{font:inherit;color:inherit}
a{color:inherit;text-decoration:none}

/* Layout */
.app{display:flex; height:100vh}

/* Desktop sidebar (left column) */
.sidebar{
  position: sticky;
  top: 0;
  height: 100vh;
  overflow: hidden;              /* list scrolls inside .times */
  width: var(--sidebar-w);
  background: var(--sidebar-bg);
  border-right:1px solid var(--border);
  padding: var(--space);
  display:flex;
  flex-direction:column;
  gap: var(--space);
}

/* Sidebar controls */
.sidebar .row{display:flex;gap:8px;align-items:center}
.sidebar select, .sidebar input[type="text"]{
  width:100%;
  background:var(--panel-bg);
  border:1px solid var(--border);
  border-radius:10px;
  padding:10px;
}
.sidebar button{
  background:var(--panel-bg);
  border:1px solid var(--border);
  border-radius:10px;
  padding:10px;
  cursor:pointer;
}
.sidebar button:hover{filter:brightness(1.1)}
.session-header{display:flex;align-items:center;gap:8px}
.session-delete{margin-left:auto;background:#261d1d}

/* Sidebar list scrolls */
.times{
  flex:1; min-height:0; overflow:auto;
  border:1px solid var(--border); border-radius:12px;
  padding:6px; background:var(--panel-bg);
}

/* Scrollbars shared */
.times, .bottomdock, .modal-body{
  scrollbar-width: thin;
  scrollbar-color: var(--scroll-thumb) var(--scroll-track);
}
.times::-webkit-scrollbar,
.bottomdock::-webkit-scrollbar,
.modal-body::-webkit-scrollbar{ width:10px; height:10px }
.times::-webkit-scrollbar-track,
.bottomdock::-webkit-scrollbar-track,
.modal-body::-webkit-scrollbar-track{
  background: var(--scroll-track); border-radius:999px;
}
.times::-webkit-scrollbar-thumb,
.bottomdock::-webkit-scrollbar-thumb,
.modal-body::-webkit-scrollbar-thumb{
  background:var(--scroll-thumb); border-radius:999px; border:2px solid var(--scroll-track);
}
.times::-webkit-scrollbar-thumb:hover,
.bottomdock::-webkit-scrollbar-thumb:hover,
.modal-body::-webkit-scrollbar-thumb:hover{ background:var(--scroll-thumb-hover) }

/* Time rows */
.time-item{ display:flex; justify-content:space-between; align-items:center; padding:10px; border-radius:10px; cursor:pointer }
.time-item:hover{background:rgba(255,255,255,0.03)}
.time-meta{display:flex;gap:8px;align-items:center;color:var(--muted);font-size:.9rem}
.time-index{font-weight:800;font-size:1.15rem;margin-right:6px}

/* Main area */
.main{flex:1; display:flex; flex-direction:column; overflow:hidden}
.topbar{
  display:flex; justify-content:space-between;
  padding:var(--space); border-bottom:1px solid var(--border)
}
.icon-btn{
  background:transparent; border:1px solid var(--border);
  border-radius:10px; padding:8px 10px; cursor:pointer
}

/* Timer area */
.timer-wrap{ flex:1; display:flex; flex-direction:column; padding:var(--space) }
.scramble{
  order:0; color:var(--text); text-align:center;
  max-width:1400px; line-height:1.4; padding:0 var(--space);
  margin:8px auto 0; font-weight:600;
  font-size:clamp(1.4rem,3vw,2.2rem);
  word-spacing: clamp(8px, 1.2vw, 18px);
}
.timer-center{order:1;flex:1;display:flex;align-items:center;justify-content:center}
.timer{
  font-size:clamp(3.5rem,10vw,7rem);
  line-height:1; letter-spacing:1px; color:var(--timer-color);
  user-select:none; transition:color .15s ease
}
.timer.holding{color:#f59e0b}
.timer.ready{color:#22c55e}

/* Bottom bar */
.bottombar{
  min-height:140px; border-top:1px solid var(--border);
  display:flex; align-items:stretch; justify-content:flex-start;
  padding:12px var(--space); gap:18px; flex-wrap:wrap
}
.bottombar .stat{
  border:1px solid var(--border); border-radius:14px; padding:14px 18px;
  min-width:180px; flex:1 1 260px; background:var(--panel-bg);
  display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center
}
.bottombar .stat .k{font-size:1rem;color:var(--muted)}
.bottombar .stat .v{font-weight:700;font-size:1.25rem;line-height:1.4}

/* Modal bits */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.85);display:flex;align-items:center;justify-content:center}
.modal{
  background:var(--panel-bg); border:1px solid var(--border); border-radius:14px;
  max-width:520px; width:92%; padding:16px; display:flex; flex-direction:column; gap:12px;
  z-index: 100000;
}
.modal .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.badge{border:1px solid var(--border);padding:6px 10px;border-radius:10px;font-size:.9rem;background:var(--panel-bg);color:#fff;cursor:pointer}
.badge:hover{filter:brightness(1.08)}
.status-OK{color:#8dffb0}
.status-PLUS2{color:#ffd27f}
.status-DNF{color:#ff8f8f}
.modal-body{min-height:420px;max-height:60vh;overflow:auto}
.tabs{display:flex;gap:6px}
.tab{padding:8px 12px;border:1px solid var(--border);background:var(--panel-bg);color:#fff;border-radius:10px;cursor:pointer}
.tab.active{outline:2px solid #3a7afe}
.data-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.data-row{display:flex;align-items:center;gap:8px;background:var(--panel-bg);border:1px solid var(--border);border-radius:10px;padding:8px}
.data-row .abbr{font-weight:600}
.data-row .qm{margin-left:auto;border:1px solid var(--border);border-radius:999px;width:20px;height:20px;display:inline-flex;align-items:center;justify-content:center;opacity:.8;cursor:help;background:var(--panel-bg)}
.modal-wide{max-width:1056px}
.data-grid.wide{grid-template-columns:1fr 1fr}
.data-row .spacer{flex:1}
.statline{opacity:.9}
.bestline{margin:6px 0 8px 0}
.stat[draggable]{cursor:grab}
.stat[draggable]:active{cursor:grabbing}

/* Bottom dock (graph area) */
.bottomdock-wrap{width:100%}
.resize-handle{
  height:12px;                 /* bigger finger target */
  cursor:ns-resize;
  background:linear-gradient(to right, transparent 0, rgba(255,255,255,.15) 50%, transparent 100%);
  border-top:1px solid var(--border);
  border-bottom:1px solid var(--border);
  user-select:none; -webkit-user-select:none;
  touch-action:none;           /* allow JS to capture touchmove */
}
.bottomdock{
  height:var(--dock-h);
  min-height:60px;
  overflow:auto;
  background:var(--panel-bg);
  border:1px solid var(--border);
  border-radius:12px 12px 0 0;
}

/* Responsive */
@media (max-width:900px){
  :root{--sidebar-w:220px}
  .timer{font-size:4rem}
}

/* ===== MOBILE LAYOUT & RESIZING (<=680px) ===== */
@media (max-width:680px){
  .app{
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
  }

  .sidebar{
    /* CRITICAL: override desktop height so max-height works */
    height: auto;                 /* <â€” this unlocks --sidebar-h */
    max-height: var(--sidebar-h); /* driven by your drag JS */
    min-height: 60px;

    position: relative;
    order: 1;                     /* below the dock */
    width: 100%;
    overflow: hidden;             /* internal areas scroll */
    border-right: none;
    border-bottom: 1px solid var(--border);
    padding: 0;                   /* keep handle flush at top */
    z-index: 2;                   /* above the dock */
  }

  /* Sticky, easy-to-grab handle that captures touch */
  .sidebar-resize{
    position: sticky;
    top: 0; left: 0; right: 0;
    height: 14px;                 /* make it grabbable */
    cursor: ns-resize;
    background: linear-gradient(
      to right,
      transparent 0,
      rgba(255,255,255,.15) 50%,
      transparent 100%
    );
    border-bottom: 1px solid var(--border);
    z-index: 10;
    user-select: none; -webkit-user-select: none;
    touch-action: none;           /* REQUIRED for smooth touch-drag */
  }

  .main{
    order: 0;
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .bottomdock{
    position: relative;           /* create stacking context */
    z-index: 1;                   /* below the sidebar/handle */
    height: var(--dock-h);
    min-height: 60px;
  }
}

/* ===== FORCE-VISIBLE, GRABBABLE SIDEBAR HANDLE ON MOBILE ===== */
@media (max-width:680px){
  /* 1) Let --sidebar-h actually control height */
  .sidebar{
    height: auto !important;             /* overrides desktop 100vh */
    max-height: var(--sidebar-h, 160px);
    min-height: 60px;
    overflow: hidden;                     /* internal areas scroll */
    padding: 0;                           /* handle sits flush at top */
    position: relative;
    z-index: 2;
    width: 100%;
    border-right: none;
    border-bottom: 1px solid var(--border);
  }

  /* 2) Make the handle obvious & easy to grab */
  .sidebar-resize{
    display: block;
    height: 12px;                         /* <-- bigger finger target */
    min-height: 12px;
    cursor: ns-resize;
    padding-bottom: 4px;
    background: linear-gradient(
      to right,
      transparent 0,
      rgba(255,255,255,.22) 50%,
      transparent 100%
    );
    border-bottom: 1px solid var(--border);
    user-select: none; -webkit-user-select: none;
    touch-action: none;                   /* critical for touch-drag */
    position: relative;                   /* no sticky needed */
    z-index: 10;
  }

  /* 3) Put padding on inner content so it doesn't overlap handle */
  .sidebar > .session-header,
  .sidebar > .times{
    padding-left: var(--space);
    padding-right: var(--space);
  }
  .sidebar > .session-header{ padding-top: var(--space); }
}

/* Optional DEBUG: uncomment to verify it's visible, then remove
.sidebar-resize{ background: rgba(255,0,0,.35) !important; }
*/


